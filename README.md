# Indusface-WAF-SIEM

The scripts are created for integrating Indusface cloud WAF with SIEM.

https://docs.indusface.com/product-user-guide-apptrana/indusface-siem

Firstly, You need to generate API/Key from the Indusface portal.

**Get Access Token,**

In order to pull the attack details logs, you need an authorization code. This authorization code is valid only for 24 hours. it can be generated by another API. Generate_AuthToken.py is used for this purpose. This can be scheduled on task schedluer, schedule it to run every 24 hours.

Update the API Key, URL and path as per your environment.

**Get Attack Details**

Pull_Logs.py is used to get attack logs from the Indusface WAF, API allows maximum of 5 min of logs, so you need to run this script every 5 min in task scheduler. 

Update the URL and path as per your environment.

Create two tasks in task scheduler,

![image](https://user-images.githubusercontent.com/79724838/160105433-35ab4bb1-e1e0-4f9f-93c7-578f2d30e25b.png)
